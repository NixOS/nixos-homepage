// One "unit" is equivalent to one pixel.
// (Assuming 14px or computed equivalent.)
@unit: 1/14rem;
@line-height: 1.429; // Empirically deduced in the browser.

// As a default
@gutter: 20*@unit;

@bs_radius: 6*@unit;
@bs_navbar_height: 40*@unit;

// Colors
@bs_color_default_foreground: #333;
@bs_color_default_background: #fff;
@bs_color_link_foreground: #08c;
@bs_color_link_hover_foreground: #005580;
@bs_color_menu_hover_foreground: #fff;
@bs_color_menu_hover_background: #0081c2;
@bs_color_menu_hover_background_start: #08c;
@bs_color_menu_hover_background_end: #0077b3;
@bs_color_nav_foreground: rgb(119, 119, 119);
@bs_color_nav_hover_foreground: @bs_color_default_foreground;

// Basic catch-all rules
// ---------------------

html {
	// Assuming a browser default font size of 16px,
	// this is equivalent to 14px from bootstrap 2
	// font-size: 14px;
	font-size: (14/16) * 100%;
	// Note that **all** sizes will be relative from now on.
	// This means that a browser defaulting to a bigger size will have a scaled
	// up website by design.

	// line-height: 20px;
	line-height: @line-height;
}

body {
	font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
	color: @bs_color_default_foreground;
	background-color: @bs_color_default_background;
	#screen-xs-max({
		padding-left: @gutter;
		padding-right: @gutter;
	});
}

input, textarea, select {
	color: @bs_color_default_foreground;
	background-color: @bs_color_default_background;
}

a, .pretend-link {
	color: @bs_color_link_foreground;
	text-decoration: none;

	&:focus {
		outline: thin dotted #333;
		outline: 5px auto -webkit-focus-ring-color;
		outline-offset: -2px
	}

	&:hover, &:focus {
		color: @bs_color_link_hover_foreground;
		text-decoration: underline;
	}
}

hr {
	border-top: 1px solid #eee;
	border-bottom: 1px solid #fff;
	margin: @gutter 0;
}

ul {
	padding: 0;
	margin-top: 0;
	margin-right: 0;
	margin-bottom: @gutter;
	margin-left: @gutter;
}

table {
	border-collapse: collapse;
}

.hide {
	display: none;
}

// General, but specific, rules
// ----------------------------

.container {
	margin: auto;
	#screen-sm-min({ width: 724*@unit; });
	#screen-md-min({ width: 940*@unit; });
	#screen-lg-min({ width: 1170*@unit; });
}

// Layout-specific rules
// ---------------------

// Rows and spans
.row,
.row-fluid {
	// This recursive mixin creates a loop.
	._span(@_i) when (@_i > 0) {
		._span((@_i - 1));
		.span@{_i} {
			flex-grow: @_i;
			flex-shrink: @_i;
			#screen-sm-min({
				max-width: @_i/12 * 100%;
			});
		}
	}
	// The maximum supported `spanN`.
	._span(12);

	#screen-sm-min({
		display: flex;
		align-items: stretch;
		& > * {
			flex-basis: 0;
			&:not(:first-child) {
				padding-left: @gutter/2;
			}
			&:not(:last-child) {
				padding-right: @gutter/2;
			}
		}
		& > .span1,
		& > .span2,
		& > .span3,
		& > .span4,
		& > .span5,
		& > .span6,
		& > .span7,
		& > .span8,
		& > .span9,
		& > .span10,
		& > .span11,
		& > .span12 {
			& > :last-child {
				margin-bottom: @gutter;
			}
		}
	});
}


// Dropdown
.dropdown {
	position: relative;
	&:not(.open) .dropdown-menu {
		display: none;
	}
	.dropdown-menu {
		display: block;
		position: absolute;
		top: 100%;
		left: 0;
		// left: 50%;
		// transform: translateX(-50%)
		min-width: 160*@unit;
	}

	.dropdown-menu {
		padding: 5*@unit 0;
		margin: 2*@unit 0 0;
		background-color: @bs_color_default_background;
		border: @unit solid rgba(0, 0, 0, 0.2);
		border-radius: @bs_radius;
		list-style-type: none;
		box-shadow: 0 5*@unit 10*@unit rgba(0,0,0,0.2);
	}

	.dropdown-menu a {
		padding: 3*@unit @gutter;
		color: @bs_color_default_foreground;
		display: block;

		&:hover, &:focus {
			color: @bs_color_menu_hover_foreground;
			background-color: @bs_color_menu_hover_background;
			background-image: linear-gradient(
				to bottom
				, @bs_color_menu_hover_background_start
				, @bs_color_menu_hover_background_end
			);
		}
	}
}

// Navbar
body > .navbar {
	&.navbar-fixed-top {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		z-index: 1050;
	}
	#screen-sm-min({
		&.navbar-fixed-top {
			position: fixed;
		}
	});
}

.navbar {
	@_height: @bs_navbar_height;

	& > * {
		height: @_height;
	}

	* {
		line-height: @_height;
	}
	ul, li {
		list-style-type: none;
	}
	a {
		display: block;
	}

	.brand {
		font-size: 20*@unit;
	}

	// TODO: Use as toggle for the responsive menu.
	.btn-navbar {
		display: none; //FIXME
	}

	.navbar-inner > .container {
		display: flex;
	}

	// Bad assumption about the structure
	.navbar-inner > .container > div {
		display: flex;
		flex-grow: 1;
	}

	ul.nav {
		margin: 0;
		padding: 0;
		display: flex;
		& > li {
		}
	}

	.pull-left {
		flex-grow: 1;
	}
	.pull-right {
		flex-grow: 0;
	}

	a {
		padding-left:  15*@unit;
		padding-right: 15*@unit;
		color: @bs_color_nav_foreground;
		&:hover, &:focus, &:active, &.active {
			color: @bs_color_nav_hover_foreground;
			text-decoration: none;
		}
	}
}

.navbar-inner {
	background-color: rgb(250, 250, 250);
	background-image: linear-gradient(rgb(255, 255, 255), rgb(242, 242, 242));
	background-repeat: repeat-x;
	border-bottom: @unit solid rgb(212, 212, 212);
	box-shadow: rgba(0, 0, 0, 0.1) 0*@unit 1*@unit 10*@unit 0*@unit;
}
